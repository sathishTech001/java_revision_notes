<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interview Revision Tool</title>
    <style>
        :root {
            --sidebar-width: 300px;
            --header-height: 60px;
            --accent-color: #007bff; /* Default accent color */
            --background-color: #f4f7f6;
            --card-background: #ffffff;
            --text-color: #333;
            --link-hover-color: #0056b3;
            --border-color: #ddd;
        }

        body.dark-mode {
            --background-color: #2c3e50;
            --card-background: #34495e;
            --text-color: #ecf0f1;
            --link-hover-color: #5dade2;
            --border-color: #4a637d;
        }

        /* Basic Reset and Layout */
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 0;
            background-color: var(--background-color);
            color: var(--text-color);
            display: flex;
            flex-direction: column;
            min-height: 100vh;
            transition: background-color 0.3s, color 0.3s;
        }

        /* Header Styling */
        .app-header {
            height: var(--header-height);
            background-color: var(--card-background);
            border-bottom: 1px solid var(--border-color);
            padding: 0 20px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .app-title {
                margin: 0;
                font-size: 1.2em;
                font-weight: 600;
                color: var(--accent-color);
                flex-shrink: 0;
        }
        .app-header h2 {
            margin: 0;
            font-size: 1.2em;
            font-weight: 600;
            color: var(--accent-color);
            flex-shrink: 0;
        }

        .header-controls {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .header-controls button {
            padding: 8px 15px;
            border: none;
            border-radius: 6px;
            background-color: var(--accent-color);
            color: white;
            font-size: 0.9em;
            cursor: pointer;
            transition: background-color 0.2s;
        }

        .header-controls button:hover {
            background-color: var(--link-hover-color);
        }

        /* Menu Dropdown Styling */
        .domain-button-container, .category-button-container {
            position: relative;
        }
        
        /* Shared Menu Styling */
        .domain-menu, .category-menu {
            position: absolute;
            top: 100%; /* Position below the button */
            right: 0;
            background-color: var(--card-background);
            border: 1px solid var(--border-color);
            border-radius: 6px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            min-width: 150px;
            z-index: 1000;
            display: none;
            flex-direction: column;
            margin-top: 5px;
        }

        .domain-menu.visible, .category-menu.visible {
            display: flex;
        }

        .domain-menu a, .category-menu a {
            padding: 10px 15px;
            text-decoration: none;
            color: var(--text-color);
            font-size: 0.9em;
            transition: background-color 0.1s, color 0.1s;
            border-bottom: 1px solid var(--border-color);
        }
        
        .domain-menu a:last-child, .category-menu a:last-child {
            border-bottom: none;
        }

        .domain-menu a:hover, .category-menu a:hover {
            background-color: var(--background-color);
        }
        
        .domain-menu a.active-category, .category-menu a.active-category {
            background-color: var(--accent-color);
            color: white;
            font-weight: bold;
        }


        /* Main Content Area */
        .main-container {
            display: flex;
            flex-grow: 1;
            overflow: hidden;
        }

        /* Sidebar Styling */
        #topic-sidebar {
            width: var(--sidebar-width);
            flex-shrink: 0;
            background-color: var(--card-background);
            border-right: 1px solid var(--border-color);
            box-shadow: 2px 0 5px rgba(0, 0, 0, 0.05);
            padding: 15px 0;
            overflow-y: auto;
            transition: transform 0.3s ease-out;
        }

        #sidebar-header {
            padding: 0 15px 15px 15px;
            border-bottom: 1px solid var(--border-color);
            margin-bottom: 15px;
        }

        #sidebar-title {
            font-size: 1.1em;
            color: var(--accent-color);
            margin: 0;
            font-weight: 600;
        }
        
        #sidebar-controls {
            display: none; /* Hidden by default, shown when topics are active */
            margin-top: 10px;
        }
        
        #sidebar-controls button {
            width: 100%;
            padding: 8px;
            background-color: var(--background-color);
            color: var(--text-color);
            border: 1px solid var(--border-color);
            border-radius: 4px;
            cursor: pointer;
            transition: background-color 0.2s, border-color 0.2s;
        }
        
        #sidebar-controls button:hover {
            background-color: var(--border-color);
        }


        #topic-list-container {
            display: flex;
            flex-direction: column;
            padding: 0 0px;
        }

        .topic-link {
            padding: 10px 15px;
            text-decoration: none;
            color: var(--text-color);
            font-size: 0.95em;
            transition: background-color 0.2s, color 0.2s;
            border-bottom: 1px dashed var(--border-color);
        }
        
        .topic-link:last-child {
            border-bottom: none;
        }

        .topic-link:hover {
            background-color: var(--background-color);
        }

        .topic-link.active {
            background-color: var(--accent-color);
            color: white;
            font-weight: bold;
        }
        
        .sub-category-link {
            font-weight: 500;
            padding-left: 10px;
            background-color: var(--background-color);
        }

        /* Content Area */
        #content-area {
            flex-grow: 1;
            padding: 20px;
            overflow-y: auto;
        }

        /* Detail Cards */
        #topic-details, #settings-page {
            max-width: 900px;
            margin: 0 auto;
        }
        
        #topic-details {
            display: none; /* Hidden by default */
        }

        .detail-card {
            background-color: var(--card-background);
            border-radius: 10px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
            border-left: 5px solid var(--accent-color);
        }

        .detail-card h3 {
            color: var(--accent-color);
            margin-top: 0;
            border-bottom: 2px solid var(--border-color);
            padding-bottom: 5px;
            font-size: 1.4em;
        }
        
        #detail-topic-name {
            font-size: 2em;
            font-weight: 700;
            color: var(--text-color);
            margin-bottom: 15px;
        }

        /* Specific Content Styling */
        #detail-key-points, #detail-qa {
            list-style: none;
            padding-left: 0;
        }

        #detail-key-points li {
            padding: 8px 0;
            border-bottom: 1px dotted var(--border-color);
            line-height: 1.5;
        }
        
        #detail-key-points li::before {
            content: "•";
            color: var(--accent-color);
            font-weight: bold;
            display: inline-block;
            width: 1em;
            margin-left: -1em;
        }

        #detail-qa li {
            padding: 10px 0;
            border-bottom: 1px solid var(--border-color);
            line-height: 1.6;
        }
        
        #detail-qa li strong {
            color: var(--accent-color);
            font-weight: 600;
        }

        #detail-code-example {
            background-color: var(--background-color);
            border: 1px solid var(--border-color);
            padding: 15px;
            border-radius: 6px;
            font-family: 'Consolas', 'Monaco', monospace;
            white-space: pre-wrap;
            overflow-x: auto;
            font-size: 0.9em;
            line-height: 1.4;
        }
        
        /* Settings Page Styling */
        #settings-page {
            padding-top: 50px;
            display: none; /* Hidden by default */
        }
        
        #settings-page h1 {
            color: var(--accent-color);
            text-align: center;
            margin-bottom: 30px;
        }
        
        .setting-group {
            background-color: var(--card-background);
            padding: 25px;
            margin-bottom: 20px;
            border-radius: 10px;
            border-left: 5px solid var(--accent-color);
        }
        
        .setting-group label {
            display: block;
            margin-bottom: 10px;
            font-weight: 600;
            font-size: 1.1em;
        }

        .setting-group input[type="color"],
        .setting-group input[type="checkbox"] {
            margin-top: 5px;
        }

        /* Initial Message Styling */
        #initial-message {
            text-align: center;
            padding-top: 100px;
            color: #888;
        }

        /* Mobile Adjustments */
        .topic-toggle-mobile {
            display: none;
        }
        
        @media (max-width: 768px) {
            :root {
                --sidebar-width: 280px;
            }
            
            .topic-toggle-mobile {
                display: block;
            }
            .app-title{
                font-size: 1.1em;
            }
            .app-header h2 {
                font-size: 1.1em;
            }

            .main-container {
                flex-direction: column;
            }

            #topic-sidebar {
                position: fixed;
                top: var(--header-height);
                left: 0;
                height: calc(100vh - var(--header-height));
                transform: translateX(-100%);
                z-index: 50;
                width: var(--sidebar-width);
            }

            #topic-sidebar.open {
                transform: translateX(0);
            }
            
            #content-area {
                padding: 15px;
            }
            
            .detail-card {
                padding: 15px;
            }
            
            .header-controls button {
                 padding: 6px 10px;
                 font-size: 0.85em;
            }
            
            .domain-menu, .category-menu {
                min-width: 120px;
                right: -5px; /* Adjust dropdown position on small screens */
            }
        }
    </style>
</head>
<body>
    <h2 class="app-title" id="current-category-title">Interview Revision</h2>
    <header class="app-header">
        <h2 class="app-title"></h2>
        <div class="header-controls">
            <div class="domain-button-container">
                <button id="domain-toggle-btn">Domain</button>
                <nav id="domain-menu" class="domain-menu">
                    </nav>
            </div>

            <div class="topic-toggle-mobile">
                <button id="topic-toggle-btn">Topics</button>
            </div>
            
            <div class="category-button-container">
                <button id="category-toggle-btn">Category</button>
                <nav id="category-menu" class="category-menu">
                    </nav>
            </div>

            <button id="settings-btn">Settings</button> 
        </div>
    </header>

    <div class="main-container">
        
        <aside id="topic-sidebar">
            <div id="sidebar-header">
                <h3 id="sidebar-title">Categories</h3>
                <div id="sidebar-controls">
                    <button id="back-to-categories-btn">← Back to Sub-Categories</button>
                </div>
            </div>
            <div id="topic-list-container">
                </div>
        </aside>

        <main id="content-area">
            
            <div id="topic-details">
                <h1 id="detail-topic-name"></h1>
                
                <div id="definition-card" class="detail-card">
                    <h3>Definition</h3>
                    <p id="detail-definition"></p>
                </div>
                
                <div id="key-points-card" class="detail-card">
                    <h3>Key Interview Points</h3>
                    <ul id="detail-key-points"></ul>
                </div>

                <div id="example-card" class="detail-card">
                    <h3>General Example/Use Case</h3>
                    <p id="detail-example"></p>
                </div>
                
                <div id="qa-card" class="detail-card">
                    <h3>Common Interview Q&A</h3>
                    <ul id="detail-qa"></ul>
                </div>
                
                <div id="code-example-card" class="detail-card">
                    <h3>Code Example</h3>
                    <pre id="detail-code-example"></pre>
                </div>
            </div>

            <div id="settings-page">
                <h1>App Settings</h1>
                
                <div class="setting-group">
                    <label for="theme-toggle">Theme Preference</label>
                    <input type="checkbox" id="theme-toggle">
                    <span id="theme-status">Light Mode</span>
                    <p style="font-size: 0.9em; margin-top: 10px;">Toggle between Light and Dark mode.</p>
                </div>

                <div class="setting-group">
                    <label for="accent-color">Accent Color</label>
                    <input type="color" id="accent-color" value="#007bff">
                    <p style="font-size: 0.9em; margin-top: 10px;">Select a custom color for highlights and buttons.</p>
                </div>
            </div>

            <div id="initial-message">
                <h2>Welcome to the Interview Revision Tool!</h2>
                <p>Select a **Domain** from the menu above to start your revision.</p>
                <p>Ensure your `data.json` file is present and correctly formatted.</p>
            </div>

        </main>
    </div>

    <script>
        // --------------------------------------------------------------------------------------
        // 1. GLOBAL DATA AND DOM REFERENCES
        // --------------------------------------------------------------------------------------
        let interviewData = null; 
        let currentCategoryKey = null; // Tracks the Domain (e.g., 'java')
        let currentSubCategoryKey = null; // Tracks the Sub-Category (e.g., 'core_concepts')
        let sidebarState = 'categories'; // Tracks what the sidebar is currently showing ('categories' or 'topics')
        
        // --- DOM References ---
        const docBody = document.body;
        const sidebar = document.getElementById('topic-sidebar');
        const sidebarTitle = document.getElementById('sidebar-title');
        const topicListContainer = document.getElementById('topic-list-container');
        const domainMenu = document.getElementById('domain-menu'); 
        const categoryMenu = document.getElementById('category-menu'); 
        const contentDetails = document.getElementById('topic-details');
        const settingsPage = document.getElementById('settings-page');
        const initialMessage = document.getElementById('initial-message');
        
        // --- Buttons ---
        const domainToggleButton = document.getElementById('domain-toggle-btn');
        const categoryToggleButton = document.getElementById('category-toggle-btn'); 
        const topicToggleButton = document.getElementById('topic-toggle-btn');
        const settingsButton = document.getElementById('settings-btn');
        const themeToggle = document.getElementById('theme-toggle');
        const accentColorInput = document.getElementById('accent-color');
        
        // --- Dynamic Elements ---
        const currentCategoryTitle = document.getElementById('current-category-title');
        const sidebarControls = document.getElementById('sidebar-controls');
        const backButton = document.getElementById('back-to-categories-btn');


        // --------------------------------------------------------------------------------------
        // 2. THEME/SETTINGS FUNCTIONS
        // --------------------------------------------------------------------------------------

        function applyTheme(isDark, accentColor) {
            docBody.classList.toggle('dark-mode', isDark);
            document.getElementById('theme-status').textContent = isDark ? 'Dark Mode' : 'Light Mode';
            document.documentElement.style.setProperty('--accent-color', accentColor);
        }

        function loadSettings() {
            const isDark = localStorage.getItem('isDarkTheme') === 'true';
            const accent = localStorage.getItem('accentColor') || '#007bff';

            themeToggle.checked = isDark;
            accentColorInput.value = accent;
            
            applyTheme(isDark, accent);
        }

        function saveSettings() {
            const isDark = themeToggle.checked;
            const accent = accentColorInput.value;
            
            localStorage.setItem('isDarkTheme', isDark);
            localStorage.setItem('accentColor', accent);
            
            applyTheme(isDark, accent);
        }
        
        // --- UI State Management ---
        function showTopicContentArea() {
            settingsPage.style.display = 'none';
            initialMessage.style.display = 'none';
            contentDetails.style.display = 'block';
            if (window.innerWidth <= 768) {
                sidebar.classList.remove('open');
            }
        }

        function showSettingsPage() {
            settingsPage.style.display = 'block';
            initialMessage.style.display = 'none';
            contentDetails.style.display = 'none';
            
            if (window.innerWidth <= 768) {
                sidebar.classList.remove('open');
            }
        }

        // --------------------------------------------------------------------------------------
        // 3. EVENT LISTENERS
        // --------------------------------------------------------------------------------------
        
        // Settings Listeners
        settingsButton.addEventListener('click', () => {
            domainMenu.classList.remove('visible');
            categoryMenu.classList.remove('visible'); 
            showSettingsPage();
        });
        themeToggle.addEventListener('change', saveSettings);
        accentColorInput.addEventListener('input', saveSettings);

        // Header Button Listeners
        domainToggleButton.addEventListener('click', () => {
            domainMenu.classList.toggle('visible');
            categoryMenu.classList.remove('visible'); 
            // Close settings if open
            if (settingsPage.style.display === 'block') {
                showTopicContentArea(); 
            }
        });
        
        categoryToggleButton.addEventListener('click', () => {
            // Only toggle if a domain is actually selected and has sub-categories
            if (currentCategoryKey && categoryMenu.children.length > 0) {
                 categoryMenu.classList.toggle('visible');
                 domainMenu.classList.remove('visible'); 
            } else {
                 alert("Please select a Domain first or the current domain has no categories.");
            }
            // Close settings if open
            if (settingsPage.style.display === 'block') {
                showTopicContentArea(); 
            }
        });

        topicToggleButton.addEventListener('click', () => {
            sidebar.classList.toggle('open');
        });

        // Sidebar Back Button Listener
        backButton.addEventListener('click', () => { 
            if (currentCategoryKey && interviewData.menu[currentCategoryKey].categories) {
                renderSubCategories(interviewData.menu[currentCategoryKey].categories);
            }
        });
        
        // Global click listener to close menus
        document.addEventListener('click', (e) => {
            // Check if click is outside both menus and buttons
            const isDomainBtn = domainToggleButton.contains(e.target);
            const isCategoryBtn = categoryToggleButton.contains(e.target);
            const isDomainMenu = domainMenu.contains(e.target);
            const isCategoryMenu = categoryMenu.contains(e.target);

            if (!isDomainBtn && !isDomainMenu) {
                domainMenu.classList.remove('visible');
            }
            if (!isCategoryBtn && !isCategoryMenu) {
                categoryMenu.classList.remove('visible');
            }
        });


        // --------------------------------------------------------------------------------------
        // 4. CORE RENDERING FUNCTIONS (Updated for two menus)
        // --------------------------------------------------------------------------------------

        /**
         * Renders all top-level Domains into the #domain-menu.
         */
        function renderMainMenu() {
            domainMenu.innerHTML = Object.keys(interviewData.menu).map(key => {
                const category = interviewData.menu[key];
                return `<a href="#" data-category-key="${key}">${category.title.toUpperCase()}</a>`;
            }).join('');
            
            domainMenu.querySelectorAll('a').forEach(link => {
                link.addEventListener('click', (e) => {
                    e.preventDefault();
                    const key = e.target.getAttribute('data-category-key');
                    switchCategory(key);
                    domainMenu.classList.remove('visible'); 
                });
            });
        }
        
        /**
         * Renders the Sub-Categories of the currently selected Domain into the #category-menu.
         */
        function renderCategoryMenu(subCategories) {
            categoryMenu.innerHTML = Object.keys(subCategories).map(subKey => {
                const subCategory = subCategories[subKey];
                return `<a href="#" data-sub-key="${subKey}">${subCategory.title}</a>`;
            }).join('');
            
            categoryMenu.querySelectorAll('a').forEach(link => {
                link.addEventListener('click', (e) => {
                    e.preventDefault();
                    const subKey = e.target.getAttribute('data-sub-key');
                    // This switches the sidebar view to show topics for this sub-category
                    switchSubCategory(subKey); 
                    categoryMenu.classList.remove('visible'); 
                });
            });
        }
        
        /**
         * Switches the main Domain (Level 1).
         * Renders Level 2 Sub-Categories into the sidebar AND the Category Menu.
         */
        function switchCategory(key) {
            if (!interviewData || !interviewData.menu[key]) return;

            currentCategoryKey = key;
            currentSubCategoryKey = null; 
            const categoryData = interviewData.menu[key];
            
            currentCategoryTitle.textContent = categoryData.title + ' Revision';
            
            // Set active style for Domain menu link
            document.querySelectorAll('#domain-menu a').forEach(link => {
                link.classList.remove('active-category');
                if (link.getAttribute('data-category-key') === key) {
                    link.classList.add('active-category');
                }
            });

            const subCategoryKeys = Object.keys(categoryData.categories || {});
            
            // 1. Always clear and render the Category Menu first
            renderCategoryMenu(categoryData.categories || {});

            if (subCategoryKeys.length > 0) {
                 // 2. RENDER Level 2 (Sub-Categories) in the sidebar
                 renderSubCategories(categoryData.categories);
                 
                 // Set up the content area with the first available topic of the first sub-category
                 const firstSubCategoryKey = subCategoryKeys[0];
                 const firstSubCategoryData = categoryData.categories[firstSubCategoryKey];
                 const topicKeys = Object.keys(firstSubCategoryData.topics || {});
                 
                 if (topicKeys.length > 0) {
                    const firstTopicKey = topicKeys[0];
                    currentSubCategoryKey = firstSubCategoryKey;
                    
                    // Display the content of the first topic
                    displayTopicContent(currentCategoryKey, currentSubCategoryKey, firstTopicKey);
                    
                    // Highlight the first sub-category link in the sidebar and category menu
                    const firstSubLinkMenu = document.querySelector(`#category-menu [data-sub-key="${firstSubCategoryKey}"]`);
                    if (firstSubLinkMenu) firstSubLinkMenu.classList.add('active-category');
                 }

            } else {
                 // No sub-categories: reset view
                 initialMessage.style.display = 'block'; 
                 contentDetails.style.display = 'none';
                 topicListContainer.innerHTML = 'No sub-categories found.'; 
                 sidebarTitle.textContent = 'Categories';
                 sidebarControls.style.display = 'none';
            }

            showTopicContentArea();
        }

        /**
         * Renders the Sub-Categories (Level 2) into the sidebar.
         */
        function renderSubCategories(subCategories) {
            sidebarState = 'categories'; 
            topicListContainer.innerHTML = ''; 
            sidebarTitle.textContent = 'Sub-Categories'; 
            sidebarControls.style.display = 'none'; 

            Object.keys(subCategories).forEach(subKey => {
                const subCategory = subCategories[subKey];
                const link = document.createElement('a');
                link.href = '#';
                link.classList.add('topic-link', 'sub-category-link'); 
                link.setAttribute('data-sub-key', subKey);
                link.textContent = subCategory.title;
                
                // Add click listener to switch to topics view (Level 3)
                link.addEventListener('click', (e) => {
                    e.preventDefault();
                    switchSubCategory(subKey);
                });

                topicListContainer.appendChild(link);
            });
        }


        /**
         * Switches the Sub-Category (Level 2) and renders the Topics (Level 3).
         */
        function switchSubCategory(subKey) {
            if (!currentCategoryKey) return;
            
            currentSubCategoryKey = subKey;
            
            const categoryData = interviewData.menu[currentCategoryKey];
            const subCategoryData = categoryData.categories[subKey];
            if (!subCategoryData) return;
            
            // --- Highlighting in Sidebar and Menu ---
            // Highlight the active sub-category link in the CATEGORY menu
            document.querySelectorAll('#category-menu a').forEach(l => l.classList.remove('active-category'));
            const activeSubMenuLink = document.querySelector(`#category-menu [data-sub-key="${subKey}"]`);
            if (activeSubMenuLink) activeSubMenuLink.classList.add('active-category');
            
            // If the sidebar is currently showing sub-category links, highlight the selected one
            if (sidebarState === 'categories') {
                document.querySelectorAll('.sub-category-link').forEach(l => l.classList.remove('active'));
                const activeSubLink = document.querySelector(`#topic-list-container [data-sub-key="${subKey}"]`);
                if (activeSubLink) activeSubLink.classList.add('active');
            }


            // 1. Render the actual TOPICS (Level 3)
            sidebarState = 'topics'; 
            topicListContainer.innerHTML = '';
            sidebarTitle.textContent = subCategoryData.title + ' Topics';
            sidebarControls.style.display = 'block'; 
            
            const topicKeys = Object.keys(subCategoryData.topics || {});

            topicKeys.forEach(topicKey => {
                const topic = subCategoryData.topics[topicKey];
                const link = document.createElement('a');
                link.href = '#';
                link.classList.add('topic-link', 'topic-detail-link');
                link.setAttribute('data-topic-key', topicKey);
                link.textContent = topic.title;

                link.addEventListener('click', (e) => {
                    e.preventDefault();
                    
                    document.querySelectorAll('.topic-detail-link').forEach(l => l.classList.remove('active'));
                    link.classList.add('active');

                    displayTopicContent(currentCategoryKey, currentSubCategoryKey, topicKey); 
                    
                    if (window.innerWidth <= 768) {
                        sidebar.classList.remove('open');
                    }
                });

                topicListContainer.appendChild(link);
            });
            
            // 2. Display the content for the very first topic 
            const firstTopicKey = topicKeys[0];
            if (firstTopicKey) {
                displayTopicContent(currentCategoryKey, currentSubCategoryKey, firstTopicKey);
                const firstTopicLink = document.querySelector(`#topic-list-container [data-topic-key="${firstTopicKey}"]`);
                if (firstTopicLink) {
                    firstTopicLink.classList.add('active');
                }
            } else {
                initialMessage.style.display = 'block'; 
                contentDetails.style.display = 'none';
            }
        }

        /**
         * Displays the content of the selected topic (Level 3).
         */
        function displayTopicContent(categoryKey, subCategoryKey, topicKey) {
            const topic = interviewData.menu[categoryKey].categories[subCategoryKey].topics[topicKey];
            
            if (!topic) return;

            showTopicContentArea(); 
            
            // 1. Topic Title and Definition
            document.getElementById('detail-topic-name').textContent = topic.title;
            document.getElementById('detail-definition').textContent = topic.definition || 'No definition available.'; 

            // 2. Interview Key Points (List)
            const keyPointsList = document.getElementById('detail-key-points');
            const keyPointsCard = document.getElementById('key-points-card');
            keyPointsList.innerHTML = '';
            if (topic.interview_key_points && topic.interview_key_points.length > 0) {
                topic.interview_key_points.forEach(point => {
                    const li = document.createElement('li');
                    li.textContent = point;
                    keyPointsList.appendChild(li);
                });
                keyPointsCard.style.display = 'block';
            } else {
                keyPointsCard.style.display = 'none';
            }
            
            // 3. Questions & Answers (List)
            const qaList = document.getElementById('detail-qa');
            const qaCard = document.getElementById('qa-card');
            qaList.innerHTML = '';
            if (topic.qa && topic.qa.length > 0) {
                topic.qa.forEach(item => {
                    const li = document.createElement('li');
                    li.innerHTML = `<strong>Q: ${item.q}</strong><br>A: ${item.a}`;
                    qaList.appendChild(li);
                });
                qaCard.style.display = 'block';
            } else {
                qaCard.style.display = 'none';
            }

            // 4. Code Example
            const codeExample = document.getElementById('detail-code-example');
            const codeExampleCard = document.getElementById('code-example-card');
            if (topic.code_example) {
                codeExample.textContent = topic.code_example;
                codeExampleCard.style.display = 'block';
            } else {
                codeExampleCard.style.display = 'none';
            }

            // 5. General Example
            const generalExample = document.getElementById('detail-example');
            const exampleCard = document.getElementById('example-card');
            if (topic.example) {
                generalExample.textContent = topic.example;
                exampleCard.style.display = 'block';
            } else {
                exampleCard.style.display = 'none';
            }
        }

        // --------------------------------------------------------------------------------------
        // 5. INITIALIZATION
        // --------------------------------------------------------------------------------------
        async function loadAndInitialize(url) {
            try {
                const response = await fetch(url);
                if (!response.ok) {
                    throw new Error(`HTTP error! Status: ${response.status} (Check if '${url}' exists in the same folder)`);
                }
                interviewData = await response.json();
                
                loadSettings(); 
                renderMainMenu();
                
                // Load the first category and its first topic
                const firstCategoryKey = Object.keys(interviewData.menu)[0];
                if (firstCategoryKey) {
                    switchCategory(firstCategoryKey);
                } else {
                    document.getElementById('initial-message').style.display = 'block'; 
                }

            } catch (error) {
                console.error("Error loading or parsing JSON data:", error);
                document.getElementById('initial-message').innerHTML = `
                    <h3>Data Loading Error!</h3>
                    <p>Could not load interview data. Please ensure 'data.json' is correct and accessible.</p>
                    <p>Error details: ${error.message}</p>
                `;
                document.getElementById('initial-message').style.display = 'block'; 
            }
        }

        document.addEventListener('DOMContentLoaded', () => {
            loadAndInitialize('data.json'); 
        });
    </script>
</body>
</html>
